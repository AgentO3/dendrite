{"name":"Dendrite","tagline":"","body":"# Dendrite\r\n\r\n> Are you looking for [downloads](https://github.com/onemorecloud/dendrite/blob/master/downloads.md),\r\n> [a tutorial](https://github.com/onemorecloud/dendrite/blob/master/tutorial.md),\r\n> or the [manifesto](https://github.com/onemorecloud/dendrite/blob/master/manifesto.md)? &lt;/clippy>\r\n\r\n\r\n## Overview\r\n\r\nDendrite scrapes your existing logs and re-emits a unified log stream in modern, sensible, structured formats like JSON and StatsD over common protocols such as TCP, UDP, and file streams.  SSL/TLS, RFC5424 Syslog, HTTP, etc., should be coming soon (Want to contribute?).\r\n\r\n## Why Dendrite?\r\n\r\n### Unified, structured logs and metrics are awesome.\r\n\r\nOnce you have a unified log stream, it's easy to build and use tools that consume, forward, and analyze your logs in scalable and understandable ways.\r\n\r\n### Logging is easier than instrumentation.\r\n\r\nAll applications generate logs. Not all applications are instrumented for metrics.\r\n\r\nThere are too many disparate instrumentation libraries such as JMX, StatsD, Metrics, Ostrich, and others.  (We might start polling them later, if people find this convenient.)\r\n\r\nFiles are easy to read. Extracting metrics and statistics out of log files can be much easier than instrumenting an entire application to emit metrics.\r\n\r\n### Configure dendrite, not every application.\r\n\r\nIn today's open-source environment, it's common for, e.g., a Ruby on Rails app, to be served by HAProxy, Nginx, a Varnish server, a Rack server, and Rails itself. And then you'll want slow query logs from your database and your Redis server... and what about your work queue system...?  The list goes on!\r\n\r\nWith Dendrite, it's easy to create and share useful configuration cookbooks for each of these services, drop them into your `/etc/dendrite/conf.d` directory, reload Dendrite, and be off and running with real-time metrics.\r\n\r\n### Dendrite is structured.\r\n\r\nLogs are more than lines of text. Dendrite understands dates, numbers, counters, timings, searchable strings, fields, and more.\r\n\r\n### Dendrite is tiny.\r\n\r\nRunning the optimized agent on your servers typically consumes less than 5MB of RAM, and very little CPU.\r\n\r\n## Configuration\r\n\r\nDendrite will load a config file at `/etc/dendrite/conf.yaml`. This is overridable with the `-f` flag. Dendrite will then load any YAML files it can find in a `conf.d` directory below the main `conf.yml` config file. The configurations in these files will be merged into the main config file. By convention, `conf.d` config files should only contain one source or destination group each.\r\n\r\nThe primary YAML file follows a format looks like this:\r\n\r\n```yml\r\nglobal:\r\n  # Where we store pointers into the current position of files\r\n  offset_dir: /var/lib/dendrite\r\n  \r\n  # Number of exiting bytes to consume when we observe a new file.  Equivalent \r\n  # to tail -n, but with bytes instead of lines.  -1 for unlimited.\r\n  max_backfill_bytes: 0\r\n  # more keys may be added in later dendrite versions\r\nsources:\r\n  # ... (usually empty, delegated to the conf.d)\r\ndestinations:\r\n  # ... (usually empty, delegated to the conf.d)\r\n```\r\n\r\nA typical conf.d yaml file looks like:\r\n\r\n```yml\r\nsources:\r\n  # a key/name for the service\r\n  syslog:\r\n  \r\n    # Astericks, etc are useful. Syntax is documented at\r\n    # http://golang.org/pkg/path/filepath/#Match\r\n    glob: /var/log/system.log\r\n\r\n    # The log lines are parsed with a RE2 regex\r\n    # (https://code.google.com/p/re2/wiki/Syntax). Named matching groups\r\n    # become columns in the structured output.\r\n    #\r\n    # This pattern parses my OS X syslog. Syslog isn't consistent, \r\n    # so this may not work on your system.\r\n    pattern: \"(?P<date>.*?:[0-9]+) (?P<user>\\\\S+) (?P<prog>\\\\w+)\\\\[(?P<pid>\\\\d+)\\\\]: (?P<text>.*)\"\r\n    \r\n    # The output of the regexp can be post-processed. This allows you\r\n    # to specify type information, etc.\r\n    #\r\n    # Current field types are string, date, tokenized, int, timestamp,\r\n    # as well as gauge, timing, and metric. The last few types are \r\n    # specialized integers, and will be treated differently by statsd.\r\n    fields:\r\n      # tstamp is the field name in the output.\r\n      tstamp:\r\n        # date is the name of the regex match group.\r\n        name: date\r\n        type: timestamp\r\n        format: \"Jan _2 15:04:05\"\r\n      line: \r\n        # you can match numbered subgroups, in addition to named ones.\r\n        group: 0\r\n      tokens: \r\n        name: text\r\n        # this will create an array of the matched tokens.\r\n        type: tokenized\r\n        pattern: \\S+\\b\r\n      text: \r\n        # If there wasn't the tokens field above, this would be \r\n        # unneccessary. All named match groups are implicitly turned into \r\n        # string fields. However, since I used the \"text\" match group  \r\n        # above, the implicit string match no longer exists.\r\n        type: string\r\n      pid:\r\n        type: int\r\n```\r\n\r\nOr for a destination `conf.d` YAML file:\r\n\r\n```yml\r\ndestinations:\r\n  # a key/url for the destination.  Typically, the scheme portion of the url\r\n  # will be of the form transport+encoding.  We currently support statsd and \r\n  # json encodings, as well as udp, tcp, and file transports.\r\n  #\r\n  # Also, the colon in urls always needs to be quoted, so as not to be \r\n  # confused with nested yaml.\r\n  stats: \"udp+statsd://foo.bar.com:1234\"\r\n```\r\n\r\n```yml\r\ndestinations:\r\n  # another example\r\n  tmp: \"file+json:///tmp/json.log\"\r\n```\r\n\r\nLook in the cookbook directory for more examples.\r\n\r\n## Getting Started\r\n\r\n1. Download the latest binary for your system from our [downloads page](https://github.com/onemorecloud/dendrite/blob/master/downloads.md).\r\n2. Walk through the  [tutorial](https://github.com/onemorecloud/dendrite/blob/master/tutorial.md).\r\n\r\n## Contributing\r\n\r\nJoin us in our [Google Group](https://groups.google.com/group/dendrite-talk) or [HipChat](https://www.hipchat.com/gKr8c8S4o) room to give feedback and chat about how you might be interested in using and/or contributing.\r\n\r\nIdeas:\r\n\r\n* Implement a cookbook entry for your favorite log format.\r\n* [Open issues](https://github.com/onemorecloud/dendrite/issues?state=open)\r\n* tackle an output protocol/encoding you'd like to see included.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}